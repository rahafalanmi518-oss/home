<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ÙˆØ­Ø¯ (ØªØ®Ø²ÙŠÙ† Ù…Ø­Ù„ÙŠ)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        /* Ø§Ù„Ø£Ù„ÙˆØ§Ù†: Ø£Ø²Ø±Ù‚ Ø¯Ø§ÙƒÙ† (#174A6A)ØŒ Ø£Ø²Ø±Ù‚ Ø³Ù…Ø§ÙˆÙŠ (#00A8E8)ØŒ Ø£Ø¨ÙŠØ¶ (#F8FFFF) */
        body { font-family: 'Arial', sans-serif; margin: 0; padding: 0; background-color: #F8FFFF; color: #333; text-align: right; direction: rtl; }
        .top-nav { background-color: #174A6A; padding: 0 30px; display: flex; justify-content: flex-end; align-items: center; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); }
        .nav-links { display: flex; flex-grow: 1; justify-content: flex-end; }
        .nav-links a { color: #C0E8F8; text-decoration: none; padding: 15px 18px; margin-right: 5px; font-size: 15px; font-weight: bold; transition: background-color 0.3s, color 0.3s; border-radius: 6px 6px 0 0; cursor: pointer; }
        .nav-links a:hover { background-color: #1F6C99; }
        .nav-links .active-tab { background-color: #00A8E8; color: white; }
        .search-box { position: relative; margin-right: 20px; }
        .search-box input { padding: 8px 10px 8px 30px; border: none; border-radius: 20px; background-color: #F8FFFF; font-size: 14px; }
        .search-box button { position: absolute; left: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; }
        .search-box i { color: #174A6A; }

        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¹Ø§Ù… */
        .container { max-width: 1200px; margin: 40px auto; padding: 35px; background-color: white; border-radius: 12px; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08); }
        h1 { color: #174A6A; border-bottom: 3px solid #E0F7FF; padding-bottom: 15px; margin-bottom: 30px; font-size: 28px; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        /* Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø­Ø§Ù„Ø© */
        .status-message { padding: 15px; margin-bottom: 20px; border-radius: 8px; font-weight: bold; border-right: 4px solid; }
        .status-message.success { background-color: #d4edda; color: #155724; border-color: #2ecc71; }
        .status-message.error { background-color: #f8d7da; color: #721c24; border-color: #e74c3c; }
        .status-message.warning { background-color: #fff3cd; color: #856404; border-color: #ffc107; }

        /* Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙˆØ§Ù„Ù†Ù…ÙˆØ°Ø¬ */
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; color: #444; }
        input[type="text"], input[type="number"], input[type="url"], select, textarea { width: 100%; padding: 10px; border: 1px solid #D0E0E8; border-radius: 5px; box-sizing: border-box; }
        .submit-button { background-color: #FFB300; color: #174A6A; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; transition: background-color 0.3s; }
        .submit-button:hover { background-color: #FF9800; }

        /* Ø¬Ø¯ÙˆÙ„ Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª */
        .data-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .data-table th, .data-table td { border: 1px solid #D0E0E8; padding: 12px; text-align: right; }
        .data-table th { background-color: #00A8E8; color: white; }
        .data-table tr:nth-child(even) { background-color: #F0F8FF; }
        .action-btn { background-color: #174A6A; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; margin-left: 5px; transition: background-color 0.3s; }
        .delete-btn { background-color: #e74c3c; }
        .share-btn { background-color: #2ecc71; }
        .search-site-btn { background-color: #ff9800; }
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ù†Ø¬ÙˆÙ… */
        .rating { color: #FFD700; font-size: 1.2em; }
        .rating i.fa-star-o { color: #ccc; }
    </style>
</head>
<body>

    <header>
        <nav class="top-nav" id="tab-nav">
            <div class="search-box">
                <input type="text" id="search-input" placeholder="Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø±Ù‚Ù…...">
                <button onclick="searchProducts()"><i class="fa fa-search"></i></button>
            </div>
            <div class="nav-links">
                <a onclick="showTab('all-products')" id="all-products-link" class="active-tab"><i class="fa fa-list"></i> Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</a>
                <a onclick="showTab('categories')" id="categories-link"><i class="fa fa-tags"></i> Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</a>
                <a onclick="showTab('edit-delete')" id="edit-delete-link"><i class="fa fa-edit"></i> ØªØ¹Ø¯ÙŠÙ„/Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬</a>
                <a onclick="showTab('add-product')" id="add-product-link"><i class="fa fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬</a>
            </div>
        </nav>
    </header>

    <main class="container">
        <div id="status-display" class="status-message" style="display:none;"></div>

        <div id="all-products" class="tab-content active">
            <h1>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h1>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬</th>
                        <th>Ø§Ù„Ø§Ø³Ù…</th>
                        <th>Ø§Ù„ØªØµÙ†ÙŠÙ</th>
                        <th>Ø§Ù„ØªÙ‚ÙŠÙŠÙ… (Ù…Ù† 5)</th>
                        <th>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£ØµÙ„ÙŠ</th>
                        <th>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ</th>
                        <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                    </tr>
                </thead>
                <tbody id="products-table-body">
                    </tbody>
            </table>
        </div>

        <div id="categories" class="tab-content">
             <h1>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</h1>
             <p>Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ù…ØµÙ…Ù… Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª.</p>
             <div style="display:flex; gap:20px; flex-wrap:wrap; margin-top:20px;">
                <div style="background-color: #F0F8FF; padding: 15px; border-radius: 8px; border: 1px solid #D0E0E8;">Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª ğŸ“±</div>
                <div style="background-color: #F0F8FF; padding: 15px; border-radius: 8px; border: 1px solid #D0E0E8;">Ø£Ø²ÙŠØ§Ø¡ ÙˆÙ…Ù„Ø§Ø¨Ø³ ğŸ‘•</div>
             </div>
        </div>

        <div id="edit-delete" class="tab-content">
             <h1>ØªØ¹Ø¯ÙŠÙ„ ÙˆØ­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h1>
             <div id="edit-form-container" style="padding: 20px; border: 1px dashed #D0E0E8; border-radius: 8px;">
                <p>Ø§Ø®ØªØ± Ù…Ù†ØªØ¬Ø§Ù‹ Ù…Ù† Ø¬Ø¯ÙˆÙ„ "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª" Ù„Ù„Ø¨Ø¯Ø¡ ÙÙŠ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ù†Ø§.</p>
             </div>
        </div>
        
        <div id="add-product" class="tab-content">
            <h1>â• Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</h1>
            
            <form id="add-product-form">
                <div class="form-group"><label for="pid">Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬ (Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… Ø§Ù„ØªÙƒØ±Ø§Ø±):</label><input type="text" id="pid" name="product_id" placeholder="Ù…Ø«Ø§Ù„: A123456" required></div>
                <div class="form-group"><label for="pname">Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬:</label><input type="text" id="pname" name="product_name" required></div>
                
                <div class="form-group">
                    <label for="search_link">Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø±ØªØ¨Ø· Ù„Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬ (Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ):</label>
                    <input type="url" id="search_link" name="search_link" 
                           value="https://tonrzsa-design.github.io/Home/"
                           placeholder="Ù…Ø«Ø§Ù„: https://tonrzsa-design.github.io/Home/">
                    <p style="font-size: 0.8em; color: #888; margin-top: 5px;">* Ù…Ù„Ø§Ø­Ø¸Ø©: Ø³ÙŠØªÙ… ÙØªØ­ Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· ÙƒÙ…Ø§ Ù‡Ùˆ Ø¨Ø§Ù„Ø¶Ø¨Ø· Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± "Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹".</p>
                </div>
                
                <div class="form-group">
                    <label for="pcategory">ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ù†ØªØ¬:</label>
                    <select id="pcategory" name="category" required>
                        <option value="">-- Ø§Ø®ØªØ± --</option>
                        <option value="Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª">Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª</option>
                        <option value="Ø£Ø²ÙŠØ§Ø¡">Ø£Ø²ÙŠØ§Ø¡</option>
                        <option value="Ù…Ù†Ø²Ù„">Ù…Ù†Ø²Ù„</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="pdescription">ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬:</label>
                    <textarea id="pdescription" name="description" rows="3" placeholder="Ø£Ø¯Ø®Ù„ ÙˆØµÙØ§Ù‹ Ù…ÙØµÙ„Ø§Ù‹ Ù„Ù„Ù…Ù†ØªØ¬ Ù‡Ù†Ø§..."></textarea>
                </div>
                
                <div style="display:flex; gap:20px;">
                    <div class="form-group" style="flex:1;"><label for="rprice">Ø§Ù„Ø³Ø¹Ø± Ù‚Ø¨Ù„ Ø§Ù„Ø®ØµÙ… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</label><input type="number" id="rprice" name="regular_price" step="0.01" placeholder="99.99"></div>
                    <div class="form-group" style="flex:1;"><label for="sprice">Ø§Ù„Ø³Ø¹Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</label><input type="number" id="sprice" name="sale_price" step="0.01" placeholder="79.99"></div>
                </div>
                
                <div class="form-group">
                    <label for="prating">ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ù†ØªØ¬ (Ù…Ù† 0 Ø¥Ù„Ù‰ 5):</label>
                    <input type="number" id="prating" name="rating" step="0.5" min="0" max="5" placeholder="Ù…Ø«Ø§Ù„: 4.5">
                </div>

                <div class="form-group" style="border: 1px dashed #D0E0E8; padding: 15px; border-radius: 8px;">
                    <label>ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬ (Ø±Ø§Ø¨Ø· URL ÙÙ‚Ø·):</label>
                    <input type="url" name="image_url" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø®Ø§Ø±Ø¬ÙŠ Ù‡Ù†Ø§ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
                </div>

                <button type="submit" class="submit-button"><i class="fa fa-save"></i> Ø­ÙØ¸ ÙˆØ¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬</button>
            </form>
        </div>

    </main>

    <script>
        const STORAGE_KEY = 'products_list_v8'; 
        const DEFAULT_SEARCH_SITE = 'https://tonrzsa-design.github.io/Home/';
        
        // ----------------------------------------------------
        // Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        // ----------------------------------------------------
        function loadProducts() {
            const data = localStorage.getItem(STORAGE_KEY);
            return data ? JSON.parse(data) : [];
        }

        function saveProducts(products) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(products));
        }

        function displayStatus(message, type = 'success') {
            const display = document.getElementById('status-display');
            display.textContent = message;
            display.className = `status-message ${type}`;
            display.style.display = 'block';
            
            setTimeout(() => {
                display.style.display = 'none';
            }, 5000);
        }

        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.classList.remove('active-tab');
            });

            document.getElementById(tabId).classList.add('active');
            document.getElementById(tabId + '-link').classList.add('active-tab');

            if (tabId === 'all-products') {
                renderProducts(loadProducts());
            }
        }
        
        function getStarRatingHTML(rating) {
            const numRating = parseFloat(rating) || 0;
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= numRating) {
                    stars += '<i class="fa fa-star"></i>'; 
                } else if (i - 0.5 === numRating) {
                    stars += '<i class="fa fa-star-half-o"></i>'; 
                } else {
                    stars += '<i class="fa fa-star-o"></i>'; 
                }
            }
            return `<span class="rating">${stars}</span>`;
        }
        
        // ----------------------------------------------------
        // âœ¨ ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ ÙÙ‚Ø·)
        // ----------------------------------------------------
        function searchProductOnSite(productId, searchLink) {
            // Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙØ®Ø²Ù† Ù„Ù„Ù…Ù†ØªØ¬ØŒ Ø£Ùˆ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
            const siteToSearch = searchLink && searchLink.trim() !== 'null' ? searchLink : DEFAULT_SEARCH_SITE;
            
            // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ ÙÙ‚Ø·
            const searchURL = siteToSearch;
            
            window.open(searchURL, '_blank');
            displayStatus(`ğŸ”— ØªÙˆØ¬ÙŠÙ‡ Ù…Ø¨Ø§Ø´Ø±: Ø¬Ø§Ø±Ù ÙØªØ­ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ: ${siteToSearch}`, 'success');
        }


        // ----------------------------------------------------
        // ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø¥Ø¶Ø§ÙØ© (Ø§Ù„Ù†Ù…ÙˆØ°Ø¬)
        // ----------------------------------------------------
        document.getElementById('add-product-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const form = e.target;
            const newProduct = {
                product_id: form.product_id.value.toUpperCase(),
                name: form.product_name.value,
                category: form.category.value,
                description: form.description.value || '', 
                regular_price: parseFloat(form.regular_price.value) || null,
                sale_price: parseFloat(form.sale_price.value) || null,
                rating: parseFloat(form.rating.value) || null,
                image_url: form.image_url.value || null,
                search_link: form.search_link.value || null 
            };

            let products = loadProducts();
            
            if (products.some(p => p.product_id === newProduct.product_id)) {
                displayStatus(`ğŸš« ÙØ´Ù„: Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬ (${newProduct.product_id}) Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹!`, 'error');
                return;
            }

            products.push(newProduct);
            saveProducts(products);
            
            displayStatus('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­ ÙˆØ­ÙØ¸Ù‡ Ù…Ø­Ù„ÙŠØ§Ù‹!', 'success');
            form.reset();
            showTab('all-products');
        });

        // ----------------------------------------------------
        // ÙˆØ¸ÙŠÙØ© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„
        // ----------------------------------------------------
        function renderProducts(productsToRender) {
            const tbody = document.getElementById('products-table-body');
            tbody.innerHTML = '';
            
            if (productsToRender.length === 0) {
                tbody.innerHTML = `<tr><td colspan="7" style="text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù…Ø¯Ø®Ù„Ø© Ø­Ø§Ù„ÙŠØ§Ù‹.</td></tr>`;
                return;
            }

            productsToRender.forEach(product => {
                const row = tbody.insertRow();
                
                row.insertCell().textContent = product.product_id;
                row.insertCell().textContent = product.name;
                row.insertCell().textContent = product.category;
                
                // Ø®Ù„ÙŠØ© Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ø§Ù„Ù†Ø¬ÙˆÙ…
                const ratingCell = row.insertCell();
                ratingCell.innerHTML = getStarRatingHTML(product.rating); 
                
                row.insertCell().textContent = product.regular_price ? `${product.regular_price.toFixed(2)} Ø±.Ø³` : '---';
                row.insertCell().textContent = product.sale_price ? `${product.sale_price.toFixed(2)} Ø±.Ø³` : '---';

                const actionsCell = row.insertCell();
                
                // ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù† Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… Ø­Ø¯ÙˆØ« Ø®Ø·Ø£ ÙÙŠ Ø³Ù„Ø§Ø³Ù„ Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ù…Ù†ÙØ±Ø¯Ø© (Single Quotes)
                const siteLink = product.search_link ? product.search_link.replace(/'/g, "\\'") : ''; 
                
                actionsCell.innerHTML = `
                    <button class="action-btn" onclick="openEditForm('${product.product_id}')"><i class="fa fa-edit"></i> ØªØ¹Ø¯ÙŠÙ„</button>
                    <button class="action-btn delete-btn" onclick="deleteProduct('${product.product_id}')"><i class="fa fa-trash"></i> Ø­Ø°Ù</button>
                    <button class="action-btn search-site-btn" onclick="searchProductOnSite('${product.product_id}', '${siteLink}')"><i class="fa fa-search"></i> Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
                    <button class="action-btn share-btn" onclick="shareProduct('${product.product_id}')"><i class="fa fa-share-alt"></i> Ù…Ø´Ø§Ø±ÙƒØ©</button>
                `;
            });
        }
        
        // ----------------------------------------------------
        // ÙˆØ¸ÙŠÙØ© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© (Share) - Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ ÙÙ‚Ø·
        // ----------------------------------------------------
        function shareProduct(productId) {
            const products = loadProducts();
            const product = products.find(p => p.product_id === productId);

            if (!product) {
                displayStatus('âŒ Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©.', 'error');
                return;
            }

            // ØªØ¬Ù‡ÙŠØ² Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
            const regularPrice = product.regular_price ? `Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£ØµÙ„ÙŠ: ${product.regular_price.toFixed(2)} Ø±.Ø³` : '';
            const salePrice = product.sale_price ? `Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ: ${product.sale_price.toFixed(2)} Ø±.Ø³` : 'Ø§Ù„Ø³Ø¹Ø± ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            const priceInfo = product.sale_price ? `${regularPrice}\nğŸ’° ${salePrice}` : `ğŸ’° ${regularPrice}`;
            const ratingText = product.rating ? `â­ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: ${product.rating} Ù…Ù† 5` : 'â­ Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ… Ø­Ø§Ù„ÙŠ.';
            
            // âœ¨ Ø¨Ù†Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ ÙÙ‚Ø·
            const siteToSearch = product.search_link && product.search_link.trim() !== 'null' ? product.search_link : DEFAULT_SEARCH_SITE;
            const directLink = siteToSearch; 

            const shareMessage = `
âœ¨ Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯ ÙˆÙ…Ù…ÙŠØ²! âœ¨
--------------------------
ğŸ·ï¸ Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬: ${product.name}
ğŸ”¢ Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬: ${product.product_id}
âš™ï¸ Ø§Ù„ØªØµÙ†ÙŠÙ: ${product.category}

${ratingText}

ğŸ“ Ø§Ù„ÙˆØµÙ: ${product.description || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ.'}
${priceInfo}

${product.image_url ? 'ğŸ”— Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©: ' + product.image_url : 'ğŸ–¼ï¸ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ù…Ø±ÙÙ‚.'}

ğŸ”— Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ: ${directLink}
(Ø§Ø¨Ø­Ø« ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬: ${product.product_id})

#Ù…Ù†ØªØ¬Ø§Øª #ØªØ³ÙˆÙ‚_Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† #Ø¹Ø±Ø¶_Ø®Ø§Øµ
            `.trim();

            // Ù…Ø­Ø§ÙˆÙ„Ø© Ù†Ø³Ø® Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰ Ø­Ø§ÙØ¸Ø© Ø§Ù„Ø¬Ù‡Ø§Ø² (Clipboard)
            if (navigator.clipboard) {
                navigator.clipboard.writeText(shareMessage).then(() => {
                    displayStatus('âœ… ØªÙ… Ù†Ø³Ø® Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ù„ØµÙ‚Ù‡Ø§ ÙˆÙ…Ø´Ø§Ø±ÙƒØªÙ‡Ø§.', 'success');
                }).catch(err => {
                    displayStatus('âš ï¸ ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ. ÙŠØ±Ø¬Ù‰ Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ù†Ø³Ø® Ø§Ù„ÙŠØ¯ÙˆÙŠ.', 'warning');
                    prompt("Ø§Ù†Ø³Ø® Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙŠØ¯ÙˆÙŠØ§Ù‹:", shareMessage);
                });
            } else {
                prompt("Ø§Ù†Ø³Ø® Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙŠØ¯ÙˆÙŠØ§Ù‹:", shareMessage);
            }
        }
        
        // ----------------------------------------------------
        // ÙˆØ¸ÙŠÙØ© ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
        // ----------------------------------------------------
        function openEditForm(productId) {
            const products = loadProducts();
            const product = products.find(p => p.product_id === productId);

            if (!product) return;

            const formHTML = `
                <h2>ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬: ${product.name}</h2>
                <form id="edit-product-form">
                    <input type="hidden" name="old_id" value="${product.product_id}">
                    
                    <div class="form-group"><label>Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬:</label><input type="text" name="product_id" value="${product.product_id}" required readonly></div>
                    <div class="form-group"><label>Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬:</label><input type="text" name="name" value="${product.name}" required></div>
                    
                    <div class="form-group">
                        <label>Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø±ØªØ¨Ø· Ù„Ù„Ø¨Ø­Ø« (Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ):</label>
                        <input type="url" name="search_link" value="${product.search_link || DEFAULT_SEARCH_SITE}">
                    </div>
                    
                    <div class="form-group">
                        <label>Ø§Ù„ØªØµÙ†ÙŠÙ:</label>
                        <select name="category" required>
                            <option value="Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª" ${product.category === 'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª' ? 'selected' : ''}>Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª</option>
                            <option value="Ø£Ø²ÙŠØ§Ø¡" ${product.category === 'Ø£Ø²ÙŠØ§Ø¡' ? 'selected' : ''}>Ø£Ø²ÙŠØ§Ø¡</option>
                            <option value="Ù…Ù†Ø²Ù„" ${product.category === 'Ù…Ù†Ø²Ù„' ? 'selected' : ''}>Ù…Ù†Ø²Ù„</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬:</label>
                        <textarea name="description" rows="3">${product.description || ''}</textarea>
                    </div>

                    <div style="display:flex; gap:20px;">
                        <div class="form-group" style="flex:1;"><label>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£ØµÙ„ÙŠ:</label><input type="number" name="regular_price" step="0.01" value="${product.regular_price || ''}"></div>
                        <div class="form-group" style="flex:1;"><label>Ø³Ø¹Ø± Ø§Ù„ØªØ®ÙÙŠØ¶:</label><input type="number" name="sale_price" step="0.01" value="${product.sale_price || ''}"></div>
                    </div>
                    
                    <div class="form-group">
                        <label>ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ù†ØªØ¬ (Ù…Ù† 0 Ø¥Ù„Ù‰ 5):</label>
                        <input type="number" name="rating" step="0.5" min="0" max="5" value="${product.rating || ''}">
                    </div>
                    
                    <div class="form-group">
                        <label>Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©:</label>
                        <input type="url" name="image_url" value="${product.image_url || ''}">
                    </div>

                    <button type="submit" class="submit-button" style="background-color:#00A8E8; color:white;"><i class="fa fa-save"></i> Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
                </form>
            `;
            
            document.getElementById('edit-form-container').innerHTML = formHTML;
            document.getElementById('edit-product-form').addEventListener('submit', handleEditSubmit);

            showTab('edit-delete');
        }

        // ----------------------------------------------------
        // ÙˆØ¸ÙŠÙØ© Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
        // ----------------------------------------------------
        function handleEditSubmit(e) {
            e.preventDefault();
            const form = e.target;
            const oldId = form.old_id.value;
            
            const updatedProduct = {
                product_id: form.product_id.value,
                name: form.name.value,
                category: form.category.value,
                description: form.description.value || '',
                regular_price: parseFloat(form.regular_price.value) || null,
                sale_price: parseFloat(form.sale_price.value) || null,
                rating: parseFloat(form.rating.value) || null,
                image_url: form.image_url ? form.image_url.value : '',
                search_link: form.search_link.value || null 
            };

            let products = loadProducts();
            const index = products.findIndex(p => p.product_id === oldId);

            if (index !== -1) {
                products[index] = updatedProduct;
                saveProducts(products);
                displayStatus('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                showTab('all-products');
            } else {
                displayStatus('âŒ ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª.', 'error');
            }
        }
        
        // ----------------------------------------------------
        // ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¹Ø§Ù… (ÙÙŠ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª)
        // ----------------------------------------------------
        function searchProducts() {
            const query = document.getElementById('search-input').value.toLowerCase();
            const products = loadProducts();
            
            const filteredProducts = products.filter(product => 
                product.name.toLowerCase().includes(query) || 
                product.product_id.toLowerCase().includes(query)
            );

            renderProducts(filteredProducts);
            if (query && filteredProducts.length > 0) {
                 displayStatus(`âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${filteredProducts.length} Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù€ "${query}"`, 'success');
            } else if (query) {
                 displayStatus(`âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù€ "${query}"`, 'warning');
            } else {
                 displayStatus(`Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª.`, 'success');
            }
        }


        // ----------------------------------------------------
        // Ø§Ù„ØªØ´ØºÙŠÙ„ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        // ----------------------------------------------------
        document.addEventListener('DOMContentLoaded', () => {
            showTab('all-products'); 
        });
    </script>

</body>
</html>